package com.aspectsecurity.contrast.contrastjenkins;

import lombok.Getter;
import lombok.Setter;

import java.util.Map;

@Getter
@Setter
public class VulnerabilityTrendResult {

    private Map<String, Integer> traceResult;
    private Map<String, Integer> severityResult;

    public VulnerabilityTrendResult(Map<String, Integer> traceResult, Map<String, Integer> severityResult) {
        this.traceResult = traceResult;
        this.severityResult = severityResult;
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();

        sb.append("<b>Vulnerability Rule Count</b>");

        for (Map.Entry<String, Integer> entry : traceResult.entrySet()) {
            sb.append("<p>");
            sb.append(entry.getKey()).append(": ").append(entry.getValue());
            sb.append("</p>");
        }

        sb.append("<br/ ><b>Vulnerability Severity Count</b>");

        for (String severity: VulnerabilityTrendHelper.SEVERITIES) {
            sb.append("<p>");
            sb.append(severity).append(": ").append(severityResult.get(severity));
            sb.append("</p>");
        }

        return sb.toString();
    }
}
